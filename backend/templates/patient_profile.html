<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Patient Profile</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
	<div class="container">
		<header>
			<h2>{% if patient %}Profile â€” {{ patient.name or ('Patient ' ~ patient.id) }}{% else %}New Patient{% endif %}</h2>
			<div><a href="{{ url_for('patient_list') }}">Back to list</a></div>
		</header>

		<main>
			{% if not patient %}
				<form method="post" action="{{ url_for('patient_new') }}">
					<label>Name: <input name="name"></label><br>
					<label>Address: <input name="address"></label><br>
					<label>Age: <input name="age" type="number"></label><br>
					<label>Height: <input name="height"></label><br>
					<label>Weight: <input name="weight"></label><br>
					<label>Previous Visit: <input name="previous_visit" type="date"></label><br>
					<label>Medical History:<br><textarea name="medical_history"></textarea></label><br>
					<label>Prescription:<br><textarea name="prescription"></textarea></label><br>
					<button type="submit">Register</button>
				</form>
			{% else %}
				{% if edit %}
					<form method="post" action="{{ url_for('patient_edit', pid=patient.id) }}">
						<label>Name: <input name="name" value="{{ patient.name }}"></label><br>
						<label>Address: <input name="address" value="{{ patient.address }}"></label><br>
						<label>Age: <input name="age" type="number" value="{{ patient.age }}"></label><br>
						<label>Height: <input name="height" value="{{ patient.height }}"></label><br>
						<label>Weight: <input name="weight" value="{{ patient.weight }}"></label><br>
						<label>Previous Visit: <input name="previous_visit" type="date" value="{{ patient.previous_visit }}"></label><br>
						<label>Medical History:<br><textarea name="medical_history">{{ patient.medical_history }}</textarea></label><br>
						<label>Prescription:<br><textarea name="prescription">{{ patient.prescription }}</textarea></label><br>
						<button type="submit">Save</button>
					</form>
				{% else %}
					<div>
						<p><strong>Name:</strong> {{ patient.name }}</p>
						<p><strong>Address:</strong> {{ patient.address }}</p>
						<p><strong>Age:</strong> {{ patient.age }}</p>
						<p><strong>Height:</strong> {{ patient.height }}</p>
						<p><strong>Weight:</strong> {{ patient.weight }}</p>
						<p><strong>Previous Visit:</strong> {{ patient.previous_visit }}</p>
						<p><strong>Medical History:</strong><br>{{ patient.medical_history }}</p>
						<p><strong>Prescription:</strong><br>{{ patient.prescription }}</p>
					</div>
					<div>
						<a href="{{ url_for('patient_edit', pid=patient.id) }}">Update Profile</a>
					</div>
					<hr>
					<h4>Transcription History</h4>
					{% if patient.transcripts and patient.transcripts|length > 0 %}
						<ul>
							{% for t in patient.transcripts %}
								<li><strong>{{ t.timestamp }}</strong>: {{ t.text }}</li>
							{% endfor %}
						</ul>
					{% else %}
						<p>No transcripts yet.</p>
					{% endif %}
				{% endif %}
			{% endif %}
		</main>
	</div>
</body>
</html>
